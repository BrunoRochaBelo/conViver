        <div class="cv-tabs" id="calendario-tabs">
            <div class="cv-tabs-buttons">
                <button class="cv-tab-button active" id="tab-agenda">Agenda</button>
                <button class="cv-tab-button" id="tab-minhas-reservas">Minhas Reservas</button>
            </div>
            <!-- Wrapper para alinhar botões à direita -->
            <div class="cv-tabs-actions" style="margin-left: auto; display: flex; align-items: center; gap: var(--cv-spacing-sm);">
                <button id="open-sort-calendario-button" class="cv-button icon-button" title="Ordenar Itens">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="6 9 12 15 18 9"></polyline>
                    </svg>
                </button>
                <button id="open-filter-calendario-button" class="cv-button icon-button" title="Filtros do Calendário">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
                    </svg>
                </button>
            </div>
        </div>

        <div class="cv-tab-content" id="content-agenda">
            <!-- Botão deslizante para alternar visualização Calendário/Lista -->
            <div class="calendario-view-toggle cv-form-group" style="display: flex; align-items: center; justify-content: flex-end; margin-bottom: var(--cv-spacing-md);">
                <label for="view-toggle-switch" class="cv-switch-label" style="margin-right: var(--cv-spacing-sm);">Calendário</label>
                <label class="cv-switch">
                    <input type="checkbox" id="view-toggle-switch"> <!-- Desmarcado = Calendário por padrão -->
                    <span class="cv-switch-slider round"></span>
                </label>
                <label for="view-toggle-switch" class="cv-switch-label" style="margin-left: var(--cv-spacing-sm);">Lista</label>
            </div>

            <!-- Container para a visualização em Calendário -->
            <div id="calendario-view-container">
                <section class="calendario-section cv-card">
                    <div class="cv-form-group" style="margin-bottom: var(--cv-spacing-md);">
                        <label for="select-espaco-comum-calendario-display">Espaço:</label>
                        <select id="select-espaco-comum-calendario-display" class="cv-input">
                            <option value="">Todos os Espaços</option>
                        </select>
                    </div>
                    <div id="calendario-container"></div> <!-- ID do FullCalendar, pode ser genérico -->
                    <!-- Lista de itens do dia selecionado no calendário -->
                    <section id="agenda-dia-list" class="js-agenda-dia-list feed-grid" style="margin-top:var(--cv-spacing-lg);">
                         <h3 style="font-size: var(--cv-font-size-lg); color: var(--current-text-secondary); margin-bottom: var(--cv-spacing-md);">Agenda para o dia selecionado:</h3>
                        <div class="feed-skeleton-container" style="display:none;">
                            <div class="cv-card feed-skeleton-item"><div class="skeleton-title skeleton-block"></div><div class="skeleton-line skeleton-block"></div><div class="skeleton-line skeleton-block skeleton-line--short"></div></div>
                        </div>
                        <div id="agenda-dia-items" class="card-grid"></div>
                    </section>
                    <div id="info-espaco-selecionado-calendario" class="cv-card cv-alert cv-alert--info" style="margin-top:var(--cv-spacing-md); display:none; font-size:0.9em;">
                        <!-- Informações do espaço selecionado no dropdown -->
                    </div>
                </section>
            </div>

            <!-- Container para a visualização em Lista Cronológica da Agenda -->
            <div id="list-view-agenda-container" style="display:none;" class="feed-grid">
                <!-- Skeleton para a lista -->
                <div class="feed-skeleton-container" style="display: none;">
                    <div class="cv-card feed-skeleton-item"><div class="skeleton-title skeleton-block"></div><div class="skeleton-line skeleton-block"></div><div class="skeleton-line skeleton-block skeleton-line--short"></div></div>
                    <div class="cv-card feed-skeleton-item"><div class="skeleton-title skeleton-block"></div><div class="skeleton-line skeleton-block"></div><div class="skeleton-line skeleton-block skeleton-line--short"></div></div>
                </div>
                <div id="list-view-agenda-items">
                    <!-- Cards de itens da agenda (lista) carregados aqui -->
                </div>
                <div id="list-view-agenda-sentinel" style="height: 10px;"></div>
                <!-- cv-empty-state e cv-error-state serão adicionados aqui via JS -->
            </div>
        </div> <!-- fim content-agenda -->

        <div class="cv-tab-content feed-grid" id="content-minhas-reservas" style="display:none;">
            <!-- Skeleton para minhas reservas -->
            <div class="feed-skeleton-container" style="display: none;">
                <div class="cv-card feed-skeleton-item"><div class="skeleton-title skeleton-block"></div><div class="skeleton-line skeleton-block"></div><div class="skeleton-line skeleton-block skeleton-line--short"></div></div>
                <div class="cv-card feed-skeleton-item"><div class="skeleton-title skeleton-block"></div><div class="skeleton-line skeleton-block"></div><div class="skeleton-line skeleton-block skeleton-line--short"></div></div>
            </div>
            <div id="minhas-reservas-list"> <!-- ID mantido conforme especificação da sub-aba -->
                <!-- Cards de "Minhas Reservas" carregados aqui -->
            </div>
            <div id="minhas-reservas-sentinel" style="height: 10px;"></div>
            <!-- cv-empty-state e cv-error-state serão adicionados aqui via JS -->
        </div>

        <!-- Seção de Gerenciar Espaços foi REMOVIDA - funcionalidade agora apenas pelo FAB -->

    <!-- FAB será inicializado por JS, não precisa do botão estático aqui se o initFabMenu for usado -->

    <div id="modal-filtros-calendario" class="cv-modal" style="display:none;">
        <div class="cv-modal-content">
            <span class="cv-modal-close js-modal-filtros-calendario-close">&times;</span>
            <h2 id="modal-filtros-calendario-title">Filtros do Calendário</h2>
            <div class="cv-form">
                <!-- Filtros para Agenda (Calendário e Lista) -->
                <div class="cv-form-group-wrapper" id="filtros-modal-calendario-agenda-content" style="display:none;">
                    <h4>Filtros da Agenda</h4>
                    <div class="cv-form-group">
                        <label for="filtro-espaco-modal-agenda">Espaço Comum:</label>
                        <select id="filtro-espaco-modal-agenda" class="cv-input">
                            <option value="">Todos os Espaços</option>
                            <!-- Populado por JS -->
                        </select>
                    </div>
                    <div class="cv-form-group">
                        <label for="filtro-data-modal-agenda">Mês/Ano (para listas):</label>
                        <input type="month" id="filtro-data-modal-agenda" class="cv-input">
                        <small>Para o Calendário, use a navegação interna para mudar o mês.</small>
                    </div>
                    <div class="cv-form-group">
                        <label for="filtro-status-modal-agenda">Status do Item:</label>
                        <select id="filtro-status-modal-agenda" class="cv-input">
                            <option value="">Todos</option>
                            <option value="Pendente">Pendente</option>
                            <option value="Confirmada">Confirmada</option>
                            <option value="Recusada">Recusada</option>
                            <option value="CanceladaPeloUsuario">Cancelada pelo Usuário</option>
                            <option value="CanceladaPeloSindico">Cancelada pelo Síndico</option>
                            <!-- Adicionar outros status se aplicável a eventos, etc. -->
                        </select>
                    </div>
                    <div class="cv-form-group">
                        <label for="filtro-tipo-item-modal-agenda">Tipo de Item:</label>
                        <select id="filtro-tipo-item-modal-agenda" class="cv-input">
                            <option value="">Todos os Tipos</option>
                            <option value="Reserva">Reserva de Espaço</option>
                            <option value="Evento">Evento</option>
                            <option value="Manutencao">Manutenção</option>
                            <option value="Servico">Serviço Agendado</option>
                        </select>
                    </div>
                    <div id="filtros-admin-modal-agenda" style="display:none;">
                        <div class="cv-form-group">
                            <label for="filtro-unidade-modal-agenda">ID da Unidade (Admin):</label>
                            <input type="text" id="filtro-unidade-modal-agenda" class="cv-input" placeholder="Guid da Unidade">
                        </div>
                    </div>
                </div>

                <!-- Filtros para Minhas Reservas -->
                <div class="cv-form-group-wrapper" id="filtros-modal-minhas-reservas-content" style="display:none;">
                    <h4>Filtros de Minhas Reservas</h4>
                    <div class="cv-form-group">
                        <label for="filtro-espaco-modal-minhas">Espaço Comum:</label>
                        <select id="filtro-espaco-modal-minhas" class="cv-input">
                            <option value="">Todos os Espaços</option>
                            <!-- Populado por JS -->
                        </select>
                    </div>
                    <div class="cv-form-group">
                        <label for="filtro-data-modal-minhas">Período (Mês/Ano):</label>
                        <input type="month" id="filtro-data-modal-minhas" class="cv-input">
                    </div>
                    <div class="cv-form-group">
                        <label for="filtro-status-modal-minhas">Situação da Reserva:</label>
                        <select id="filtro-status-modal-minhas" class="cv-input">
                            <option value="">Todas</option>
                            <option value="Pendente">Pendente</option>
                            <option value="Confirmada">Confirmada</option>
                            <option value="Recusada">Recusada</option>
                            <option value="CanceladaPeloUsuario">Cancelada pelo Usuário</option>
                            <option value="CanceladaPeloSindico">Cancelada pelo Síndico</option>
                        </select>
                    </div>
                     <!-- Adicionar filtro de tipo para "Minhas Reservas" se elas puderem ser de tipos diferentes -->
                </div>

                <div class="cv-form-actions">
                    <button id="aplicar-filtros-modal-calendario" class="cv-button cv-button--primary">Aplicar Filtros</button>
                    <button type="button" id="limpar-filtros-modal-calendario" class="cv-button">Limpar Filtros</button>
                    <button type="button" class="cv-button js-modal-filtros-calendario-close">Cancelar</button>
                </div>
            </div>
        </div>
    </div>

    <div id="modal-sort-calendario" class="cv-modal" style="display:none;">
        <div class="cv-modal-content">
            <span class="cv-modal-close js-modal-sort-calendario-close">&times;</span>
            <h2>Ordenação de Itens do Calendário</h2>
            <div class="cv-form">
                <div class="cv-form-group">
                    <label for="sort-order-select-calendario">Ordenar por:</label>
                    <select id="sort-order-select-calendario" class="cv-input">
                        <option value="dataInicioDesc">Data de Início (Mais Recente)</option>
                        <option value="dataInicioAsc">Data de Início (Mais Antiga)</option>
                        <option value="dataSolicitacaoDesc">Data da Criação (Mais Recente)</option>
                        <option value="dataSolicitacaoAsc">Data da Criação (Mais Antiga)</option>
                        <option value="statusAsc">Status (A-Z)</option>
                        <option value="statusDesc">Status (Z-A)</option>
                        <option value="tipoItemAsc">Tipo de Item (A-Z)</option>
                        <option value="tipoItemDesc">Tipo de Item (Z-A)</option>
                    </select>
                </div>
                <div class="cv-form-actions">
                    <button id="apply-sort-button-calendario" class="cv-button cv-button--primary">Aplicar</button>
                    <button type="button" id="clear-sort-button-calendario-modal" class="cv-button">Limpar Ordenação</button>
                    <button type="button" class="cv-button js-modal-sort-calendario-close">Cancelar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modais Específicos de Itens do Calendário -->
    <div id="modal-novo-item-calendario" class="cv-modal" style="display:none;">
        <div class="cv-modal-content">
            <span class="cv-modal-close js-modal-novo-item-calendario-close">&times;</span>
            <h2 id="modal-novo-item-calendario-title">Novo Item no Calendário</h2>
            <form id="form-novo-item-calendario" class="cv-form">
                <input type="hidden" id="modal-item-id" name="itemId">

                <div class="cv-form-group" id="modal-item-tipo-group" style="display:none;"> <!-- Inicialmente oculto, JS controla visibilidade -->
                    <label for="modal-item-tipo">Tipo de Item:</label>
                    <select id="modal-item-tipo" name="tipoItem" class="cv-input">
                        <option value="Reserva" selected>Reserva de Espaço</option>
                        <option value="Evento">Evento</option>
                        <option value="Reuniao">Reunião</option>
                        <option value="Manutencao">Manutenção Programada</option>
                        <option value="Servico">Serviço Agendado</option>
                        <!-- Outros tipos podem ser adicionados aqui -->
                    </select>
                </div>

                <div class="cv-form-group">
                    <label for="modal-item-espaco">Espaço Comum (opcional para eventos/outros tipos):</label>
                    <select id="modal-item-espaco" name="espacoComumId" class="cv-input"></select>
                </div>
                <div id="modal-info-espaco-item" class="cv-card cv-alert cv-alert--info" style="margin-bottom:var(--cv-spacing-md); font-size:0.9em; display:none;"></div>
                <div class="cv-form-group">
                    <label for="modal-item-titulo">Título (para mural/agenda):</label>
                    <input type="text" id="modal-item-titulo" name="tituloParaMural" class="cv-input" required>
                </div>
                <div class="cv-form-group">
                    <label for="modal-item-data">Data:</label>
                    <input type="date" id="modal-item-data" name="data" class="cv-input" required>
                </div>
                <div class="cv-form-group">
                    <label for="modal-item-inicio">Horário de Início:</label>
                    <input type="time" id="modal-item-inicio" name="inicio" class="cv-input" step="1800" required>
                </div>
                <div class="cv-form-group">
                    <label for="modal-item-fim">Horário de Fim:</label>
                    <input type="time" id="modal-item-fim" name="fim" class="cv-input" step="1800" required>
                </div>
                <div class="cv-form-group">
                    <label for="modal-item-observacoes">Observações/Descrição (opcional):</label>
                    <textarea id="modal-item-observacoes" name="observacoes" class="cv-input" rows="3"></textarea>
                </div>
                <div class="cv-form-group" id="modal-item-unidade-sindico-group" style="display:none;">
                    <label for="modal-item-unidade-sindico">Unidade (Síndico, se aplicável):</label>
                    <input type="text" id="modal-item-unidade-sindico" name="unidadeId" placeholder="ID da Unidade" class="cv-input">
                </div>
                <div class="cv-form-group" id="modal-item-termos-group">
                    <input type="checkbox" id="modal-item-termos" name="termos" required style="vertical-align: middle; margin-right: var(--cv-spacing-xs);">
                    <label for="modal-item-termos" style="display:inline-block; vertical-align: middle;">Li e aceito os <a href="#" id="link-termos-uso-item" class="cv-link">termos de uso</a> (se aplicável).</label>
                </div>
                <div id="modal-item-taxa-info" class="cv-alert cv-alert--info" style="margin-bottom: var(--cv-spacing-md); font-weight: bold; display:none;"></div>
                <div class="cv-form-actions">
                    <button type="submit" id="btn-submit-novo-item" class="cv-button cv-button--primary">Agendar Item</button>
                    <button type="button" class="cv-button js-modal-novo-item-calendario-close">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <div id="modal-detalhe-item-calendario" class="cv-modal" style="display:none;">
        <div class="cv-modal-content">
            <span class="cv-modal-close js-modal-detalhe-item-calendario-close">&times;</span>
            <h2 id="modal-detalhe-item-calendario-title">Detalhes do Item</h2>
            <div id="modal-detalhe-item-calendario-conteudo" style="margin-bottom: var(--cv-spacing-lg);">
            </div>
            <div id="modal-detalhe-item-sindico-justificativa-group" class="cv-form-group" style="display:none; margin-top:var(--cv-spacing-md);">
                <label for="modal-detalhe-item-sindico-justificativa">Justificativa (para recusa/cancelamento):</label>
                <textarea id="modal-detalhe-item-sindico-justificativa" class="cv-input" rows="2"></textarea>
            </div>
            <div class="cv-form-actions" style="margin-top: var(--cv-spacing-lg); flex-wrap: wrap; justify-content: flex-end; gap: var(--cv-spacing-sm);">
                <button type="button" class="cv-button cv-button--success syndic-action" id="btn-aprovar-item-modal" style="display:none;">Aprovar</button>
                <button type="button" class="cv-button cv-button--danger syndic-action" id="btn-recusar-item-modal" style="display:none;">Recusar</button>
                <button type="button" class="cv-button syndic-action" id="btn-editar-item-modal-trigger" style="display:none;">Editar Item</button>
                <button type="button" class="cv-button cv-button--danger" id="btn-cancelar-item-modal" style="display:none;">Cancelar Item</button>
                <button type="button" class="cv-button js-modal-detalhe-item-calendario-close" style="margin-left: auto;">Fechar</button>
            </div>
        </div>
    </div>

    <div id="modal-gerenciar-espaco-comum" class="cv-modal" style="display:none;"> <!-- Modal de Espaço Comum mantido, pois é uma entidade distinta -->
        <div class="cv-modal-content">
            <span class="cv-modal-close js-modal-gerenciar-espaco-close">&times;</span>
            <h2 id="modal-gerenciar-espaco-title">Adicionar Novo Espaço Comum</h2> <!-- Título pode ser dinâmico (Adicionar/Editar) -->
            <form id="form-gerenciar-espaco-comum" class="cv-form">
                <input type="hidden" id="espaco-comum-id" name="id">
                <div class="cv-form-group">
                    <label for="espaco-nome">Nome do Espaço:</label>
                    <input type="text" id="espaco-nome" name="nome" class="cv-input" required>
                </div>
                <div class="cv-form-group">
                    <label for="espaco-descricao">Descrição:</label>
                    <textarea id="espaco-descricao" name="descricao" class="cv-input" rows="2"></textarea>
                </div>
                <div class="cv-form-group">
                    <label for="espaco-capacidade">Capacidade (pessoas):</label>
                    <input type="number" id="espaco-capacidade" name="capacidade" class="cv-input" min="0">
                </div>
                <div class="cv-form-group">
                    <label for="espaco-taxa">Taxa de Agendamento (R$):</label>
                    <input type="number" id="espaco-taxa" name="taxaReserva" class="cv-input" min="0" step="0.01">
                </div>
                <div class="cv-form-group">
                    <label for="espaco-horario-inicio">Horário Funcionamento (Início):</label>
                    <input type="time" id="espaco-horario-inicio" name="horarioFuncionamentoInicio" class="cv-input">
                </div>
                <div class="cv-form-group">
                    <label for="espaco-horario-fim">Horário Funcionamento (Fim):</label>
                    <input type="time" id="espaco-horario-fim" name="horarioFuncionamentoFim" class="cv-input">
                </div>
                <div class="cv-form-group">
                    <label for="espaco-tempo-min">Tempo Mín. Agendamento (minutos):</label>
                    <input type="number" id="espaco-tempo-min" name="tempoMinimoReservaMinutos" class="cv-input" min="0">
                </div>
                <div class="cv-form-group">
                    <label for="espaco-tempo-max">Tempo Máx. Agendamento (minutos):</label>
                    <input type="number" id="espaco-tempo-max" name="tempoMaximoReservaMinutos" class="cv-input" min="0">
                </div>
                <div class="cv-form-group">
                    <label for="espaco-antecedencia-max-dias">Antecedência Máx. Agendamento (dias):</label>
                    <input type="number" id="espaco-antecedencia-max-dias" name="antecedenciaMaximaReservaDias" class="cv-input" min="0">
                </div>
                <div class="cv-form-group">
                    <label for="espaco-antecedencia-min-cancel-horas">Antecedência Mín. Cancelamento (horas):</label>
                    <input type="number" id="espaco-antecedencia-min-cancel-horas" name="antecedenciaMinimaCancelamentoHoras" class="cv-input" min="0">
                </div>
                <div class="cv-form-group">
                    <label for="espaco-limite-mes">Limite Agendamentos/Unidade/Mês:</label>
                    <input type="number" id="espaco-limite-mes" name="limiteReservasPorUnidadeMes" class="cv-input" min="0">
                </div>
                <div class="cv-form-group">
                    <label for="espaco-dias-indisponiveis">Dias Indisponíveis (separados por vírgula):</label>
                    <input type="text" id="espaco-dias-indisponiveis" name="diasIndisponiveis" class="cv-input" placeholder="Ex: Segunda, 25/12, Feriados">
                    <small>Use nomes de dias da semana (Segunda, Terça...) ou datas (DD/MM ou DD/MM/YYYY).</small>
                </div>
                <div class="cv-form-group">
                    <input type="checkbox" id="espaco-requer-aprovacao" name="requerAprovacaoSindico" style="vertical-align: middle; margin-right: var(--cv-spacing-xs);">
                    <label for="espaco-requer-aprovacao" style="display:inline-block; vertical-align: middle;">Requer Aprovação do Síndico</label>
                </div>
                <div class="cv-form-group">
                    <input type="checkbox" id="espaco-exibir-mural" name="exibirNoMural" style="vertical-align: middle; margin-right: var(--cv-spacing-xs);">
                    <label for="espaco-exibir-mural" style="display:inline-block; vertical-align: middle;">Exibir agendamentos deste espaço no Mural Digital</label>
                </div>
                <div class="cv-form-group">
                    <input type="checkbox" id="espaco-permite-visualizacao-publica" name="permiteVisualizacaoPublicaDetalhes" style="vertical-align: middle; margin-right: var(--cv-spacing-xs);">
                    <label for="espaco-permite-visualizacao-publica" style="display:inline-block; vertical-align: middle;">Permitir que outros condôminos vejam detalhes dos agendamentos (além de "ocupado")</label>
                </div>
                <div class="cv-form-actions">
                    <button type="submit" class="cv-button cv-button--primary">Salvar Espaço Comum</button>
                    <button type="button" class="cv-button js-modal-gerenciar-espaco-close">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <div id="modal-termos-uso-item-calendario" class="cv-modal" style="display:none;">
        <div class="cv-modal-content">
            <span class="cv-modal-close js-modal-termos-uso-item-close">&times;</span>
            <h2>Termos de Uso para Agendamento de Itens/Espaços</h2>
            <p>Exemplo de Termos (pode ser dinâmico com base no tipo de item):</p>
            <ol>
                <li>O solicitante é responsável pela conservação do espaço (se aplicável).</li>
                <li>Respeitar os horários de funcionamento e níveis de ruído.</li>
                <li>Taxas aplicáveis devem ser pagas conforme regimento interno.</li>
                <li>Para eventos, seguir as normas de conduta do condomínio.</li>
            </ol>
            <div class="cv-form-actions">
                <button type="button" class="cv-button js-modal-termos-uso-item-close">Fechar</button>
            </div>
        </div>
    </div>
