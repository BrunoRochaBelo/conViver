        <div class="cv-tabs" id="reservas-tabs">
            <div class="cv-tabs-buttons">
                <button class="cv-tab-button active" id="tab-agenda">Agenda</button>
                <button class="cv-tab-button" id="tab-minhas-reservas">Minhas Reservas</button>
            </div>
            <!-- Botões de Ação Globais para a Página -->
            <button id="open-sort-reservas-button" class="cv-button icon-button" title="Ordenar">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="6 9 12 15 18 9"></polyline>
                </svg>
            </button>
            <button id="open-filter-reservas-button" class="cv-button icon-button" title="Filtros">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
                </svg>
            </button>
        </div>

        <div class="cv-tab-content active" id="content-agenda">
            <div class="reservas-view-toggle">
                <button id="btn-view-calendario" class="cv-button cv-button--primary">Calendário</button>
                <button id="btn-view-lista" class="cv-button">Lista Cronológica</button>
            </div>

            <!-- Container para a Visualização em Calendário -->
            <div id="calendario-view-container" class="reservas-view">
                <section class="reservas-section">
                    <!-- Título removido, filtros movidos para modal -->
                    <div id="calendario-reservas" class="cv-card"></div> <!-- Calendário em si -->
                    <section id="agenda-dia-list" class="js-agenda-dia-list card-grid-single-column" style="margin-top:var(--cv-spacing-lg);">
                        <div class="feed-skeleton-container" style="display:none;">
                            <div class="cv-card feed-skeleton-item"><div class="skeleton-title skeleton-block"></div><div class="skeleton-line skeleton-block"></div><div class="skeleton-line skeleton-block skeleton-line--short"></div></div>
                        </div>
                        <div id="agenda-dia-reservas-items"></div> <!-- Detalhes do dia selecionado -->
                    </section>
                    <div id="info-espaco-selecionado-calendario" class="cv-card cv-alert cv-alert--info" style="margin-top:var(--cv-spacing-md); display:none; font-size:0.9em;">
                        <!-- Info do espaço selecionado no filtro do calendário (se aplicável) -->
                    </div>
                </section>
                 <div class="cv-empty-state" id="agenda-calendario-empty" style="display: none;">
                    <img src="/img/illustrations/calendar-empty.svg" alt="Nenhuma reserva" class="cv-empty-state__image">
                    <p class="cv-empty-state__message">Nenhuma reserva encontrada para os filtros atuais no calendário.</p>
                </div>
                <div class="cv-error-state" id="agenda-calendario-error" style="display: none;">
                    <img src="/img/illustrations/undraw_warning_cyit.svg" alt="Erro" class="cv-empty-state__image">
                    <p class="cv-empty-state__message">Falha ao carregar a agenda. Tente novamente.</p>
                    <button class="cv-button cv-button--primary js-try-again-button" data-content-id="content-agenda-calendario">Tentar Novamente</button>
                </div>
            </div>

            <!-- Container para a Visualização em Lista Cronológica -->
            <div id="list-view-container" class="reservas-view card-grid-single-column" style="display:none;">
                <section class="reservas-section">
                    <!-- Título removido, filtros movidos para modal -->
                    <div class="feed-skeleton-container" style="display:none;">
                        <div class="cv-card feed-skeleton-item"><div class="skeleton-title skeleton-block"></div><div class="skeleton-line skeleton-block"></div><div class="skeleton-line skeleton-block skeleton-line--short"></div></div>
                        <div class="cv-card feed-skeleton-item"><div class="skeleton-title skeleton-block"></div><div class="skeleton-line skeleton-block"></div><div class="skeleton-line skeleton-block skeleton-line--short"></div></div>
                    </div>
                    <div id="list-view-reservas-items" class="card-list-content">
                        <!-- Cards de reserva da lista cronológica carregados aqui -->
                    </div>
                    <div id="list-view-sentinel" style="height: 10px;"></div>
                </section>
                 <div class="cv-empty-state" id="agenda-lista-empty" style="display: none;">
                    <img src="/img/illustrations/empty-box.svg" alt="Nenhuma reserva" class="cv-empty-state__image">
                    <p class="cv-empty-state__message">Nenhuma reserva encontrada para os filtros atuais na lista.</p>
                </div>
                <div class="cv-error-state" id="agenda-lista-error" style="display: none;">
                    <img src="/img/illustrations/undraw_warning_cyit.svg" alt="Erro" class="cv-empty-state__image">
                    <p class="cv-empty-state__message">Falha ao carregar a lista de reservas. Tente novamente.</p>
                    <button class="cv-button cv-button--primary js-try-again-button" data-content-id="content-agenda-lista">Tentar Novamente</button>
                </div>
            </div>
        </div> <!-- fim content-agenda -->

        <div class="cv-tab-content card-grid-single-column" id="content-minhas-reservas" style="display:none;">
            <section class="reservas-section">
                <!-- Título removido, filtros movidos para modal -->
                <div class="feed-skeleton-container" style="display:none;">
                    <div class="cv-card feed-skeleton-item"><div class="skeleton-title skeleton-block"></div><div class="skeleton-line skeleton-block"></div><div class="skeleton-line skeleton-block skeleton-line--short"></div></div>
                    <div class="cv-card feed-skeleton-item"><div class="skeleton-title skeleton-block"></div><div class="skeleton-line skeleton-block"></div><div class="skeleton-line skeleton-block skeleton-line--short"></div></div>
                </div>
                <div id="minhas-reservas-list" class="card-list-content">
                    <!-- Cards de "Minhas Reservas" carregados aqui -->
                </div>
                <div id="minhas-reservas-sentinel" style="height: 10px;"></div>
            </section>
            <div class="cv-empty-state" id="minhas-reservas-empty" style="display: none;">
                <img src="/img/illustrations/personal-notes.svg" alt="Nenhuma reserva" class="cv-empty-state__image">
                <p class="cv-empty-state__message">Você ainda não possui reservas ou nenhuma corresponde aos filtros aplicados.</p>
                <button class="cv-button cv-button--primary js-nova-reserva-fab-action">Fazer Nova Reserva</button>
            </div>
            <div class="cv-error-state" id="minhas-reservas-error" style="display: none;">
                <img src="/img/illustrations/undraw_warning_cyit.svg" alt="Erro" class="cv-empty-state__image">
                <p class="cv-empty-state__message">Falha ao carregar suas reservas. Tente novamente.</p>
                <button class="cv-button cv-button--primary js-try-again-button" data-content-id="content-minhas-reservas">Tentar Novamente</button>
            </div>
        </div>

        <!-- Seção de Admin para Espaços Comuns (opcional, pode ser movida para uma página de admin) -->
        <section id="admin-espacos-section" class="reservas-section cv-card" style="display:none; margin-top: var(--cv-spacing-lg);">
            <h3 class="cv-section__title">Gerenciar Espaços Comuns</h3>
            <div class="cv-form-actions" style="justify-content: flex-start; margin-bottom: var(--cv-spacing-md);">
                <button id="btn-adicionar-espaco" class="cv-button cv-button--primary js-admin-action">Adicionar Novo Espaço</button>
            </div>
            <div id="admin-espacos-grid" class="card-grid">
                <!-- Cards de espaços comuns para admin -->
            </div>
        </section>

    <!-- Botão FAB movido para ser inicializado pelo JS (fabMenu.js) -->

    <!-- Modal de Filtros Unificado -->
    <div id="modal-filtros-reservas" class="cv-modal" style="display:none;">
        <div class="cv-modal-content">
            <span class="cv-modal-close js-modal-filtros-reservas-close">&times;</span>
            <h2 id="modal-filtros-reservas-title">Filtros</h2>
            <form id="form-filtros-reservas" class="cv-form">
                <!-- Filtros para Aba Agenda (Calendário e Lista) -->
                <div class="cv-form-group-wrapper" data-context="agenda">
                    <div class="cv-form-group">
                        <label for="filtro-espaco-comum-agenda">Espaço Comum:</label>
                        <select id="filtro-espaco-comum-agenda" name="espacoComumId" class="cv-input">
                            <option value="">Todos os Espaços</option>
                            <!-- Populado por JS -->
                        </select>
                    </div>
                    <div class="cv-form-group" data-view-context="lista"> <!-- Apenas para view de lista da agenda -->
                        <label for="filtro-periodo-agenda-lista">Período (Mês/Ano):</label>
                        <input type="month" id="filtro-periodo-agenda-lista" name="periodo" class="cv-input">
                    </div>
                </div>

                <!-- Filtros para Aba Minhas Reservas -->
                <div class="cv-form-group-wrapper" data-context="minhas-reservas" style="display:none;">
                    <div class="cv-form-group">
                        <label for="filtro-espaco-comum-minhas">Espaço Comum:</label>
                        <select id="filtro-espaco-comum-minhas" name="espacoComumId" class="cv-input">
                            <option value="">Todos os Espaços</option>
                            <!-- Populado por JS -->
                        </select>
                    </div>
                    <div class="cv-form-group">
                        <label for="filtro-periodo-minhas">Período (Mês/Ano):</label>
                        <input type="month" id="filtro-periodo-minhas" name="periodo" class="cv-input">
                    </div>
                    <div class="cv-form-group">
                        <label for="filtro-status-minhas">Situação:</label>
                        <select id="filtro-status-minhas" name="status" class="cv-input">
                            <option value="">Todas</option>
                            <option value="Pendente">Pendente</option>
                            <option value="Confirmada">Confirmada</option>
                            <option value="Recusada">Recusada</option>
                            <option value="CanceladaPeloUsuario">Cancelada</option>
                        </select>
                    </div>
                </div>
                <div class="cv-form-actions">
                    <button type="submit" id="aplicar-filtros-modal-reservas" class="cv-button cv-button--primary">Aplicar Filtros</button>
                    <button type="button" id="limpar-filtros-modal-reservas" class="cv-button">Limpar Filtros</button>
                    <button type="button" class="cv-button js-modal-filtros-reservas-close">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal de Ordenação -->
    <div id="modal-sort-reservas" class="cv-modal" style="display:none;">
        <div class="cv-modal-content">
            <span class="cv-modal-close js-modal-sort-reservas-close">&times;</span>
            <h2>Ordenar Reservas</h2>
            <form id="form-sort-reservas" class="cv-form">
                 <div class="cv-form-group">
                    <label for="sort-by-reservas">Ordenar por:</label>
                    <select id="sort-by-reservas" name="sortBy" class="cv-input">
                        <option value="dataInicio">Data de Início</option>
                        <option value="dataSolicitacao">Data da Solicitação</option>
                        <option value="nomeEspaco">Nome do Espaço</option>
                    </select>
                </div>
                <div class="cv-form-group">
                    <label for="sort-direction-reservas">Direção:</label>
                    <select id="sort-direction-reservas" name="sortDirection" class="cv-input">
                        <option value="asc">Crescente (Mais Antigas Primeiro)</option>
                        <option value="desc">Decrescente (Mais Recentes Primeiro)</option>
                    </select>
                </div>
                <div class="cv-form-actions">
                    <button type="submit" id="aplicar-sort-modal-reservas" class="cv-button cv-button--primary">Aplicar Ordenação</button>
                    <button type="button" id="limpar-sort-modal-reservas" class="cv-button">Limpar Ordenação</button>
                    <button type="button" class="cv-button js-modal-sort-reservas-close">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para Solicitar/Editar Reserva -->
    <div id="modal-nova-reserva" class="cv-modal" style="display:none;">
        <div class="cv-modal-content">
            <span class="cv-modal-close js-modal-nova-reserva-close">&times;</span>
            <h2 id="modal-nova-reserva-title">Solicitar Nova Reserva</h2>
            <form id="form-nova-reserva" class="cv-form">
                <input type="hidden" id="modal-reserva-id" name="reservaId">
                <div class="cv-form-group">
                    <label for="modal-reserva-espaco">Espaço Comum:</label>
                    <select id="modal-reserva-espaco" name="espacoComumId" class="cv-input" required></select>
                </div>
                <div id="modal-info-espaco-reserva" class="cv-card cv-alert cv-alert--info" style="margin-bottom:var(--cv-spacing-md); font-size:0.9em; display:none;"></div>
                <div class="cv-form-group">
                    <label for="modal-reserva-data">Data:</label>
                    <input type="date" id="modal-reserva-data" name="data" class="cv-input" required>
                </div>
                <div class="cv-form-group">
                    <label for="modal-reserva-inicio">Horário de Início:</label>
                    <input type="time" id="modal-reserva-inicio" name="inicio" class="cv-input" step="1800" required>
                </div>
                <div class="cv-form-group">
                    <label for="modal-reserva-fim">Horário de Fim:</label>
                    <input type="time" id="modal-reserva-fim" name="fim" class="cv-input" step="1800" required>
                </div>
                <div class="cv-form-group">
                    <label for="modal-reserva-observacoes">Observações (opcional):</label>
                    <textarea id="modal-reserva-observacoes" name="observacoes" class="cv-input" rows="3"></textarea>
                </div>
                <div class="cv-form-group" id="modal-reserva-unidade-sindico-group" style="display:none;">
                    <label for="modal-reserva-unidade-sindico">Unidade (Síndico):</label>
                    <input type="text" id="modal-reserva-unidade-sindico" name="unidadeId" placeholder="ID da Unidade" class="cv-input">
                </div>
                <div class="cv-form-group">
                    <input type="checkbox" id="modal-reserva-termos" name="termos" required style="vertical-align: middle; margin-right: var(--cv-spacing-xs);">
                    <label for="modal-reserva-termos" style="display:inline-block; vertical-align: middle;">Li e aceito os <a href="#" id="link-termos-uso-reserva" class="cv-link">termos de uso</a>.</label>
                </div>
                <div id="modal-reserva-taxa-info" class="cv-alert cv-alert--info" style="margin-bottom: var(--cv-spacing-md); font-weight: bold; display:none;"></div>
                <div class="cv-form-actions">
                    <button type="submit" id="btn-submit-nova-reserva" class="cv-button cv-button--primary">Solicitar Reserva</button>
                    <button type="button" class="cv-button js-modal-nova-reserva-close">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <div id="modal-detalhe-reserva" class="cv-modal" style="display:none;">
        <div class="cv-modal-content">
            <span class="cv-modal-close js-modal-detalhe-reserva-close">&times;</span>
            <h2 id="modal-detalhe-reserva-title">Detalhes da Reserva</h2>
            <div id="modal-detalhe-reserva-conteudo" style="margin-bottom: var(--cv-spacing-lg);">
            </div>
            <div id="modal-detalhe-reserva-sindico-justificativa-group" class="cv-form-group" style="display:none; margin-top:var(--cv-spacing-md);">
                <label for="modal-detalhe-reserva-sindico-justificativa">Justificativa (para recusa/cancelamento):</label>
                <textarea id="modal-detalhe-reserva-sindico-justificativa" class="cv-input" rows="2"></textarea>
            </div>
            <div class="cv-form-actions" style="margin-top: var(--cv-spacing-lg); flex-wrap: wrap; justify-content: flex-end; gap: var(--cv-spacing-sm);">
                <button type="button" class="cv-button cv-button--success syndic-action" id="btn-aprovar-reserva-modal" style="display:none;">Aprovar</button>
                <button type="button" class="cv-button cv-button--danger syndic-action" id="btn-recusar-reserva-modal" style="display:none;">Recusar</button>
                <button type="button" class="cv-button syndic-action" id="btn-editar-reserva-modal-trigger" style="display:none;">Editar Reserva</button>
                <button type="button" class="cv-button cv-button--danger" id="btn-cancelar-reserva-modal" style="display:none;">Cancelar Reserva</button>
                <button type="button" class="cv-button js-modal-detalhe-reserva-close" style="margin-left: auto;">Fechar</button>
            </div>
        </div>
    </div>

    <div id="modal-gerenciar-espaco-comum" class="cv-modal" style="display:none;">
        <div class="cv-modal-content">
            <span class="cv-modal-close js-modal-gerenciar-espaco-close">&times;</span>
            <h2 id="modal-gerenciar-espaco-title">Adicionar Novo Espaço Comum</h2>
            <form id="form-gerenciar-espaco-comum" class="cv-form">
                <input type="hidden" id="espaco-comum-id" name="id">
                <div class="cv-form-group">
                    <label for="espaco-nome">Nome do Espaço:</label>
                    <input type="text" id="espaco-nome" name="nome" class="cv-input" required>
                </div>
                <div class="cv-form-group">
                    <label for="espaco-descricao">Descrição:</label>
                    <textarea id="espaco-descricao" name="descricao" class="cv-input" rows="2"></textarea>
                </div>
                <div class="cv-form-group">
                    <label for="espaco-capacidade">Capacidade (pessoas):</label>
                    <input type="number" id="espaco-capacidade" name="capacidade" class="cv-input" min="0">
                </div>
                <div class="cv-form-group">
                    <label for="espaco-taxa">Taxa de Reserva (R$):</label>
                    <input type="number" id="espaco-taxa" name="taxaReserva" class="cv-input" min="0" step="0.01">
                </div>
                <div class="cv-form-group">
                    <label for="espaco-horario-inicio">Horário Funcionamento (Início):</label>
                    <input type="time" id="espaco-horario-inicio" name="horarioFuncionamentoInicio" class="cv-input">
                </div>
                <div class="cv-form-group">
                    <label for="espaco-horario-fim">Horário Funcionamento (Fim):</label>
                    <input type="time" id="espaco-horario-fim" name="horarioFuncionamentoFim" class="cv-input">
                </div>
                <div class="cv-form-group">
                    <label for="espaco-tempo-min">Tempo Mín. Reserva (minutos):</label>
                    <input type="number" id="espaco-tempo-min" name="tempoMinimoReservaMinutos" class="cv-input" min="0">
                </div>
                <div class="cv-form-group">
                    <label for="espaco-tempo-max">Tempo Máx. Reserva (minutos):</label>
                    <input type="number" id="espaco-tempo-max" name="tempoMaximoReservaMinutos" class="cv-input" min="0">
                </div>
                <div class="cv-form-group">
                    <label for="espaco-antecedencia-max-dias">Antecedência Máx. Reserva (dias):</label>
                    <input type="number" id="espaco-antecedencia-max-dias" name="antecedenciaMaximaReservaDias" class="cv-input" min="0">
                </div>
                <div class="cv-form-group">
                    <label for="espaco-antecedencia-min-cancel-horas">Antecedência Mín. Cancelamento (horas):</label>
                    <input type="number" id="espaco-antecedencia-min-cancel-horas" name="antecedenciaMinimaCancelamentoHoras" class="cv-input" min="0">
                </div>
                <div class="cv-form-group">
                    <label for="espaco-limite-mes">Limite Reservas/Unidade/Mês:</label>
                    <input type="number" id="espaco-limite-mes" name="limiteReservasPorUnidadeMes" class="cv-input" min="0">
                </div>
                <div class="cv-form-group">
                    <label for="espaco-dias-indisponiveis">Dias Indisponíveis (separados por vírgula):</label>
                    <input type="text" id="espaco-dias-indisponiveis" name="diasIndisponiveis" class="cv-input" placeholder="Ex: Segunda, 25/12, Feriados">
                    <small>Use nomes de dias da semana (Segunda, Terça...) ou datas (DD/MM ou DD/MM/YYYY).</small>
                </div>
                <div class="cv-form-group">
                    <input type="checkbox" id="espaco-requer-aprovacao" name="requerAprovacaoSindico" style="vertical-align: middle; margin-right: var(--cv-spacing-xs);">
                    <label for="espaco-requer-aprovacao" style="display:inline-block; vertical-align: middle;">Requer Aprovação do Síndico</label>
                </div>
                <div class="cv-form-group">
                    <input type="checkbox" id="espaco-exibir-mural" name="exibirNoMural" style="vertical-align: middle; margin-right: var(--cv-spacing-xs);">
                    <label for="espaco-exibir-mural" style="display:inline-block; vertical-align: middle;">Exibir Reservas deste espaço no Mural Digital</label>
                </div>
                <div class="cv-form-group">
                    <input type="checkbox" id="espaco-permite-visualizacao-publica" name="permiteVisualizacaoPublicaDetalhes" style="vertical-align: middle; margin-right: var(--cv-spacing-xs);">
                    <label for="espaco-permite-visualizacao-publica" style="display:inline-block; vertical-align: middle;">Permitir que outros condôminos vejam detalhes das reservas (além de "ocupado")</label>
                </div>
                <div class="cv-form-actions">
                    <button type="submit" class="cv-button cv-button--primary">Salvar Espaço Comum</button>
                    <button type="button" class="cv-button js-modal-gerenciar-espaco-close">Cancelar</button>
                </div>
            </form>
        </div>
    </div>

    <div id="modal-termos-uso-reserva" class="cv-modal" style="display:none;">
        <div class="cv-modal-content">
            <span class="cv-modal-close js-modal-termos-uso-close">&times;</span>
            <h2>Termos de Uso para Reserva de Áreas Comuns</h2>
            <p>Exemplo de Termos:</p>
            <ol>
                <li>O solicitante é responsável pela conservação do espaço.</li>
                <li>Respeitar os horários de funcionamento e níveis de ruído.</li>
                <li>Taxas aplicáveis devem ser pagas conforme regimento interno.</li>
            </ol>
            <div class="cv-form-actions">
                <button type="button" class="cv-button js-modal-termos-uso-close">Fechar</button>
            </div>
        </div>
    </div>
